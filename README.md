# Fat_Fish

## è¿™æ˜¯ä»€ä¹ˆï¼Ÿ

```text
  ä¸€ä¸ªæå–ç½‘ç«™ä¸­å¯èƒ½çš„å‚æ•°ï¼Œä½œä¸ºå­—å…¸ï¼ˆéœ€è¦è‡ªå·±å¯¹ç»“æœå»é‡ï¼‰

  æˆ‘æ˜¯ä¸ªå°ä¸‘ğŸ¤¡ï¼Œâ”­â”®ï¹â”­â”®ã€‚ çœ‹å®Œäº†å…¬å…±å·æ–‡ç« ï¼Œè¯•è¯•å®ƒè¯´çš„æ’ä»¶ï¼Œç»“æœè¯•äº†åŠå¤©burpsuiteæŠ¥é”™ï¼Œå¥½å¥½å¥½ï¼Œè‡ªå·±å†™ã€‚æ²¡æƒ³åˆ°å†™å¥½äº†åˆ·å¾®ä¿¡å…¬å·çš„æ—¶å€™çœ‹åˆ°äº†å…¶ä»–å¤§ä½¬å†™å¥½çš„å·¥å…·ï¼Œè¿˜æ˜¯ä¿©ï¼Œå‘œå‘œ
  - https://github.com/theLSA/burp-sensitive-param-extractor
  - https://github.com/goddemondemongod/god_param?tab=readme-ov-file
       
   æƒ³èµ·äº† "è€å¢¨ï¼Œæˆ‘æƒ³åƒé±¼å•¦" äºæ˜¯å–äº†ä¸ªåå­—å« fat_fishï¼Œå¸Œæœ›å¸¦æ¥ä¸°æ”¶å§ï¼Œæ¡€æ¡€æ¡€
```

## åŠŸèƒ½ä»‹ç»
    å¾ˆç®€å•ï¼Œä½œä¸ºä»£ç†æœåŠ¡å™¨ï¼Œç›‘å¬è¯·æ±‚ï¼Œè·å–è¯·æ±‚ä»¥åŠå“åº”çš„æ•°æ®ä¸­çš„å¯èƒ½çš„å‚æ•°åç§°ï¼Œæä¾›ç»™æœªæˆæƒæµ‹è¯•ä½¿ç”¨çš„å‚æ•°ã€‚

## é€»è¾‘ï¼š
- å°±æ˜¯åŒ¹é…è¡¨å•ï¼Œæå–å‚æ•°
- çœ‹å‚æ•°å¯èƒ½çš„æ ¼å¼å°± {å‚æ•°: "å‚æ•°å€¼"}
- ç„¶åè¿‡æ»¤æ‰å¸¸è§çš„httpå¤´éƒ¨ï¼ˆæ„Ÿè°¢å¤§ä½¬çš„ https://github.com/synacktiv/HopLa ï¼Œå˜¿å˜¿ï¼Œ httpå¤´éƒ¨å°±æ˜¯ä»è¿™é‡Œé¢æ‹¿æ¥ç”¨çš„ï¼‰
- è¿‡æ»¤æ‰ä¸ç¬¦åˆå‘½åè§„èŒƒçš„
- è¿‡æ»¤æ‰å¸¸è§çš„jsæ–‡ä»¶
  
## æ¨¡å—ä»‹ç»
    fingeræ¨¡å—:
        è‡ªå®šä¹‰æŒ‡çº¹ï¼š
            ä»…ä»…å®ç°äº†ç®€å•å¸¸è§çš„jsæ–‡ä»¶çš„æŒ‡çº¹ï¼Œåç»­é‡è§ä»€ä¹ˆè‡ªå·±æ·»åŠ å³å¯ã€‚æä¾›ç»™fat_fish è¿‡æ»¤ å¸¸è§çš„ jsåº“ æ–‡ä»¶
        æŒ‡çº¹è§„åˆ™åŒ¹é…çš„æ–¹å¼: 
            1. æ–‡ä»¶çš„md5ï¼ˆmd5ï¼‰
            2. æ–‡ä»¶ä¸­å­˜åœ¨çš„å…³é”®å­— (keyword)
            3. æ­£åˆ™åŒ¹é… (reg)
        è§„åˆ™å¤„ç†é€»è¾‘: 
            1. &&  å…¨éƒ¨åŒ¹é…åˆ™ç®—å‘½ä¸­
            2. ||  åŒ¹é…åˆ°ä¸€ä¸ªå³ç®—å‘½ä¸­
    
    extractæ¨¡å—:
        æå–æ¨¡å—, å®ç°å‚æ•°çš„æå–ï¼Œ æå–çš„è§„åˆ™: 
        æå–:
            1. {"": ""} æ ¼å¼çš„
            2. url ä¸­å‡ºç°çš„å¯èƒ½çš„å‚æ•°
            3. input è¡¨å•ä¸­çš„ å‚æ•°
        è¿‡æ»¤:
            1. å¯¹å‡ºç°çš„ http  å¤´éƒ¨è¿›è¡Œè¿‡æ»¤
            2. ä¸ç¬¦åˆå˜é‡å‘½åè§„èŒƒçš„
            3. ç”¨æˆ·è‡ªå®šä¹‰çš„å‚æ•°è¿‡æ»¤

    fat_fishå…¥å£æ–‡ä»¶:
        ç¨‹åºçš„å…¥å£è„šæœ¬ï¼Œé€šè¿‡å®‰è£… mitmproxy åº“ï¼Œç„¶åå®‰è£…ä»–çš„è¯ä¹¦ï¼Œåˆ©ç”¨å®ƒåŠ«æŒå“åº”æ•°æ®ã€‚å°†æ•°æ®å‘é€ç»™ finger å’Œ extract æ¨¡å—å¤„ç†
        finger -> å‘é€ è¯·æ±‚çš„ body æ•°æ®ï¼Œ
        extract -> å‘é€ è¯·æ±‚çš„ body å’Œ  url
        bypass_patterns æŒ‡å®šè¿‡æ»¤çš„ url ä¸è¿›è¡Œæå–

## æ³¨æ„:
    å¯åŠ¨ä½¿ç”¨:
        mitmproxy -s  .\fat_fish.py
    ç›‘å¬ç«¯å£:
        é»˜è®¤ 8080 å’Œ burpsuite ç›‘å¬ç«¯å£ç›¸åŒ
        ä½¿ç”¨ mitmproxy -p 8081 -s  .\fat_fish.py åˆ‡æ¢ç«¯å£
    è¯ä¹¦å®‰è£…:
        è¯ä¹¦è®°å¾—å®‰è£…ï¼Œä¸ç„¶æŠ“ä¸äº†httpsæµé‡, å¯ä»¥é€‰æ‹©æˆ‘ä¸‹è½½å¥½çš„ï¼Œå®‰è£…ï¼Œä¹Ÿå¯å¯åŠ¨åè®¿é—® mitm.it æ¥ä¸‹è½½è¯ä¹¦
    æ·»åŠ æŒ‡çº¹:
        finger/fingers.py ä¸­æ·»åŠ 
    æ·»åŠ ä¸æå–çš„å‚æ•°åç§°:
        extract/extractparam.py ä¸­çš„ BYPASS_LIST æ·»åŠ 
    æ·»åŠ ä¸åŒ¹é…çš„ url:
        fat_fish.py ä¸­çš„ bypass_patterns
    å¦‚æœæ·»åŠ äº†è§„åˆ™ï¼Œå¹¶ä¸”ç¡®å®šè§„åˆ™æ²¡é—®é¢˜ã€‚åˆ™çœ‹çœ‹æœ«å°¾æ˜¯å¦æ¼äº†, 

```python
BYPASS_LIST = [
'_',
''
]
```
![13f909da0b79b8341ff15a5ce5c194a](https://github.com/user-attachments/assets/e6c39463-48e3-40b1-ab18-8a127bd50080)

